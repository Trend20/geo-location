<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<link rel="stylesheet" href="ol.css" type="text/css" />
	<link rel="stylesheet" href="samples.css" type="text/css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="GXml.js"></script>
    <script type="text/javascript">
	
    function loadTrack() 
	{		
        $.get("readfromDB.php", function(data)
		{
			var xml = GXml.parse(data);
			var markers = xml.documentElement.getElementsByTagName("marker");
	        var sourceM = new ol.source.Vector();		
			for (var i = 0; i < markers.length; i++) 
			{
				var ID = markers[i].getAttribute("ID");
				var myLatLng = {lat: parseFloat(markers[i].getAttribute("latitude")), lng: parseFloat(markers[i].getAttribute("longitude"))};

				sourceM.addFeature(new ol.Feature({
					geometry: new ol.geom.Point(ol.proj.fromLonLat([parseFloat(markers[i].getAttribute("longitude")), parseFloat(markers[i].getAttribute("latitude"))])),
					name: 'test'
				}));			
			}
			map.getView().setCenter(ol.proj.transform([parseFloat(markers[markers.length-1].getAttribute("longitude")), parseFloat(markers[markers.length-1].getAttribute("latitude"))], 'EPSG:4326', 'EPSG:3857'));
			var markersLayer = new ol.layer.Vector({
				source: sourceM,
				style: new ol.style.Style({
					image: new ol.style.Icon({
						src: 'marker.png',
						anchor: [0.5, 1]
					})
				})
			});	
			map.addLayer(markersLayer);			
        });
    }
	</script>
  </head>
 
  <body>
   <script src="ol.js"></script>
   <div id="mapDiv" class="map"></div>
   <script>
			var osmLayer = new ol.layer.Tile
			({
				source: new ol.source.OSM()
			});
			var birmingham = ol.proj.transform([-1.81185, 52.44314],'EPSG:4326', 'EPSG:3857');
			var view = new ol.View
			({
				center: birmingham,
				zoom: 17
			});
			var map = new ol.Map
			({
				target: 'mapDiv'
			});
			map.addLayer(osmLayer);
			map.setView(view);
			loadTrack();
    </script>	
  </body>
</html>
